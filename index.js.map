{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".search-form\")\nconst input = document.querySelector(\".search-input\")\nconst galleryMenu = document.querySelector(\".gallery\")\nconst loader = document.querySelector(\".loader\");\nconst loadMore = document.querySelector(\".load-more-btn\")\n\nform.addEventListener(\"submit\", handleSearch)\nloadMore.addEventListener(\"click\", onLoadMore)\n\nconst API_KEY = \"47599452-88585afd800a8eb35bdc3af8b\";\nconst BASE_URL = \"https://pixabay.com/api/\";\nlet page = 1;\nlet currentQury = \"\";\nlet loadedHits = 0;\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nasync function fetchImages(currentQury = \"\" , page = 1) {\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: currentQury,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        page,\n        per_page: 15\n    });\n    try {\n        const response = await axios(`${BASE_URL}?${params}`)\n        console.log(response);\n        return response.data;\n    } catch (error) {\n        throw new Error(res.statusText);\n    }\n}\n\n async function handleSearch(event) {\n    event.preventDefault();\n    currentQury = input.value.trim();\n\n    if (!currentQury) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Please enter a keyword to search.\",\n            position: \"topRight\",\n        });\n        return;\n    }\n    showLoader();\n\n     galleryMenu.innerHTML = \"\";\n     page = 1;\n     loadedHits = 0;\n     \n     try {\n         const data = await fetchImages(currentQury); \n\n         if (!data.hits.length) {\n             iziToast.error({\n                 message: \"Sorry, there are no images matching your search query. Please try again!\",\n                 position: \"topRight\",\n             });\n             return;\n         }\n         galleryMenu.innerHTML = createMarkup(data.hits);\n         loadedHits = data.hits.length;\n         lightbox.refresh();\n\n         console.log(data.hits);\n         console.log(data.totalHits);\n\n         if (loadedHits < data.totalHits) {\n         loadMore.classList.remove(\"hidden\");\n         } else {\n             loadMore.classList.add(\"hidden\");\n         }\n         \n         \n     } catch (error) {\n        console.error(error);\n        iziToast.error({\n            title: \"Error\",\n            message: \"An error occurred while fetching images. Please try again later.\",\n            position: \"topRight\",\n        });\n    } finally {\n        hideLoader(); \n        form.reset(); \n     }\n}\nfunction createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n            <li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                    <img\n                        class=\"gallery-image\"\n                        src=\"${webformatURL}\"\n                        alt=\"${tags}\"\n                    />\n                </a>\n                <ul class=\"gallery-item-categories-menu\">\n                    <li class=\"gallery-item-categories-menu-item\">\n                        <p class=\"categories-item-title\">Likes</p>\n                        <p class=\"categories-item-count\">${likes}</p>\n                    </li>\n                    <li class=\"gallery-item-categories-menu-item\">\n                        <p class=\"categories-item-title\">Views</p>\n                        <p class=\"categories-item-count\">${views}</p>\n                    </li>\n                    <li class=\"gallery-item-categories-menu-item\">\n                        <p class=\"categories-item-title\">Comments</p>\n                        <p class=\"categories-item-count\">${comments}</p>\n                    </li>\n                    <li class=\"gallery-item-categories-menu-item\">\n                        <p class=\"categories-item-title\">Downloads</p>\n                        <p class=\"categories-item-count\">${downloads}</p>\n                    </li>\n                </ul>\n            </li>\n        `;\n    }).join(\"\");\n}\nfunction showLoader() {\n    loader.textContent = \"Loading images, please wait...\"; \n    loader.classList.remove(\"hidden\");\n}\n\nfunction hideLoader() {\n    loader.classList.add(\"hidden\");\n}\n\nasync function onLoadMore() {\n        page += 1;\n        try {\n            const data = await fetchImages(currentQury, page);\n            galleryMenu.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits))\n            loadedHits += data.hits.length;\n            lightbox.refresh();\n\n            if (loadedHits >= data.totalHits) {\n            loadMore.classList.add(\"hidden\");\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n            });\n        }\n        } catch (error) {\n            alert(error.message);\n     }\n}"],"names":["form","input","galleryMenu","loader","loadMore","handleSearch","onLoadMore","API_KEY","BASE_URL","page","currentQury","loadedHits","lightbox","SimpleLightbox","fetchImages","params","response","axios","event","iziToast","showLoader","data","createMarkup","error","hideLoader","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}